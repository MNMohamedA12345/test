<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Developer Homepage</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/babel-standalone@6.26.0/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen px-4 sm:px-6 md:px-8 py-8">
  <div id="root" className="w-full md:w-[70%] max-w-7xl mx-auto"></div>
  <div id="error-fallback" className="hidden text-center text-red-700 p-4"></div>
  <script type="text/babel">
    function Homepage() {
      const [developerId] = React.useState(localStorage.getItem('developer_id') || '');
      const [userName] = React.useState(localStorage.getItem('user_name') || 'User');
      const [email] = React.useState(localStorage.getItem('email') || '');
      const [password] = React.useState(localStorage.getItem('password') || '');
      const [permissions, setPermissions] = React.useState(localStorage.getItem('permissions') || 'low');
      const [activeTab, setActiveTab] = React.useState('activities');
      const [activities, setActivities] = React.useState([]);
      const [projects, setProjects] = React.useState([]);
      const [tasks, setTasks] = React.useState([]);
      const [developers, setDevelopers] = React.useState([]);
      const [dropdownData, setDropdownData] = React.useState({ developers: [], projects: [], tasks: [] });
      const [newActivity, setNewActivity] = React.useState({
        project_id: '',
        task_id: '',
        details: '',
        status: 'To_Do',
        estimated_days: ''
      });
      const [newProject, setNewProject] = React.useState({
        name: '',
        description: '',
        status: 'To_Do',
        delivery_date: '',
        priority: ''
      });
      const [newTask, setNewTask] = React.useState({
        title: '',
        description: ''
      });
      const [newDeveloper, setNewDeveloper] = React.useState({
        first_name: '',
        last_name: '',
        email: '',
        password: '',
        permissions: 'low'
      });
      const [editActivity, setEditActivity] = React.useState(null);
      const [editProject, setEditProject] = React.useState(null);
      const [editTask, setEditTask] = React.useState(null);
      const [editDeveloper, setEditDeveloper] = React.useState(null);
      const [error, setError] = React.useState('');
      const [success, setSuccess] = React.useState('');
      const [loading, setLoading] = React.useState(false);
      const API_BASE_URL = 'https://fastapi.engineeringdevelopment.online';
      var activityFormRef = React.useRef(null);
      var projectFormRef = React.useRef(null);
      var taskFormRef = React.useRef(null);
      var developerFormRef = React.useRef(null);

      React.useEffect(function() {
        if (!developerId || !email || !password) {
          window.location.href = 'login.html';
          return;
        }
        var fetchData = async function() {
          setLoading(true);
          try {
            var permResponse = await fetch(API_BASE_URL + '/me?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password));
            if (!permResponse.ok) throw new Error('Failed to load permissions');
            var permData = await permResponse.json();
            setPermissions(permData.permissions || 'low');
            localStorage.setItem('permissions', permData.permissions || 'low');

            var actResponse = await fetch(API_BASE_URL + '/activities?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password));
            if (!actResponse.ok) throw new Error('Failed to load activities');
            var actData = await actResponse.json();
            setActivities(Array.isArray(actData) ? actData : []);

            var projResponse = await fetch(API_BASE_URL + '/projects?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password));
            if (!projResponse.ok) throw new Error('Failed to load projects');
            var projData = await projResponse.json();
            var normalizedProjects = (projData || []).map(function(project) {
              return {
                project_id: project.project_id,
                name: project.name || '',
                description: project.description || null,
                status: project.status || 'To_Do',
                delivery_date: project.delivery_date || null,
                priority: project.priority || null
              };
            });
            setProjects(normalizedProjects);

            var taskResponse = await fetch(API_BASE_URL + '/tasks?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password));
            if (!taskResponse.ok) throw new Error('Failed to load tasks');
            var taskData = await taskResponse.json();
            var normalizedTasks = (taskData || []).map(function(task) {
              return {
                task_id: task.task_id,
                title: task.title || '',
                description: task.description || null
              };
            });
            setTasks(normalizedTasks);

            if (permissions === 'high') {
              var devResponse = await fetch(API_BASE_URL + '/developers?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password));
              if (!devResponse.ok) throw new Error('Failed to load developers');
              var devData = await devResponse.json();
              var normalizedDevelopers = (devData || []).map(function(developer) {
                return {
                  developer_id: developer.developer_id,
                  first_name: developer.first_name || '',
                  last_name: developer.last_name || '',
                  name: `${developer.first_name} ${developer.last_name}`.trim(),
                  email: developer.email || '',
                  permissions: developer.permissions || 'low'
                };
              });
              setDevelopers(normalizedDevelopers);
            }

            var dropdownResponse = await fetch(API_BASE_URL + '/dropdown-data');
            if (!dropdownResponse.ok) throw new Error('Failed to load dropdown data');
            var dropData = await dropdownResponse.json();
            var normalizedDropdownDevelopers = (dropData.developers || []).map(function(developer) {
              return {
                developer_id: developer.developer_id,
                first_name: developer.first_name || '',
                last_name: developer.last_name || '',
                name: `${developer.first_name} ${developer.last_name}`.trim(),
                email: developer.email || '',
                permissions: developer.permissions || 'low'
              };
            });
            setDropdownData({
              developers: normalizedDropdownDevelopers,
              projects: dropData.projects || [],
              tasks: dropData.tasks || []
            });
          } catch (err) {
            setError(err.message);
          } finally {
            setLoading(false);
          }
        };
        fetchData();
      }, [developerId, email, password, permissions]);

      var handleTabChange = function(tab) {
        setActiveTab(tab);
        setError('');
        setSuccess('');
        setEditActivity(null);
        setEditProject(null);
        setEditTask(null);
        setEditDeveloper(null);
      };

      var handleEditActivity = function(activity) {
        setEditActivity(activity);
        setTimeout(function() { if (activityFormRef.current) activityFormRef.current.scrollIntoView({ behavior: 'smooth' }); }, 0);
      };

      var handleEditProject = function(project) {
        setEditProject(project);
        setTimeout(function() { if (projectFormRef.current) projectFormRef.current.scrollIntoView({ behavior: 'smooth' }); }, 0);
      };

      var handleEditTask = function(task) {
        setEditTask(task);
        setTimeout(function() { if (taskFormRef.current) taskFormRef.current.scrollIntoView({ behavior: 'smooth' }); }, 0);
      };

      var handleEditDeveloper = function(developer) {
        setEditDeveloper({
          developer_id: developer.developer_id,
          first_name: developer.first_name,
          last_name: developer.last_name,
          email: developer.email,
          permissions: developer.permissions,
          password: ''
        });
        setTimeout(function() { if (developerFormRef.current) developerFormRef.current.scrollIntoView({ behavior: 'smooth' }); }, 0);
      };

      var handleAddActivity = async function(e) {
        e.preventDefault();
        setLoading(true);
        var activityData = {
          project_id: parseInt(newActivity.project_id),
          task_id: parseInt(newActivity.task_id),
          details: newActivity.details || null,
          status: newActivity.status,
          estimated_days: parseInt(newActivity.estimated_days) || null
        };
        try {
          var response = await fetch(API_BASE_URL + '/activities?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(activityData)
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to add activity: ' + (errorText || response.statusText));
          }
          var data = await response.json();
          setActivities(activities.concat([data]));
          setSuccess('Activity added successfully');
          setNewActivity({ project_id: '', task_id: '', details: '', status: 'To_Do', estimated_days: '' });
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var updateActivityStatus = async function(activityId, newStatus) {
        setLoading(true);
        try {
          var response = await fetch(API_BASE_URL + '/activities/' + activityId + '/status?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'PATCH',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ status: newStatus })
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to update status: ' + (errorText || response.statusText));
          }
          setActivities(activities.map(function(activity) {
            return activity.activity_id === activityId ? Object.assign({}, activity, { status: newStatus }) : activity;
          }));
          setSuccess('Status updated successfully');
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var updateActivity = async function(activity) {
        setLoading(true);
        var activityData = {
          project_id: parseInt(activity.project_id),
          task_id: parseInt(activity.task_id),
          details: activity.details || null,
          status: activity.status,
          estimated_days: parseInt(activity.estimated_days) || null
        };
        try {
          var response = await fetch(API_BASE_URL + '/activities/' + activity.activity_id + '?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(activityData)
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to update activity: ' + (errorText || response.statusText));
          }
          var data = await response.json();
          setActivities(activities.map(function(a) { return a.activity_id === activity.activity_id ? data : a; }));
          setEditActivity(null);
          setSuccess('Activity updated successfully');
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var deleteActivity = async function(activityId) {
        setLoading(true);
        try {
          var response = await fetch(API_BASE_URL + '/activities/' + activityId + '?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'DELETE'
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to delete activity: ' + (errorText || response.statusText));
          }
          setActivities(activities.filter(function(a) { return a.activity_id !== activityId; }));
          setSuccess('Activity deleted successfully');
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var handleAddProject = async function(e) {
        e.preventDefault();
        setLoading(true);
        var projectData = {
          name: newProject.name,
          description: newProject.description || null,
          status: newProject.status,
          delivery_date: newProject.delivery_date || null,
          priority: newProject.priority || null
        };
        try {
          var response = await fetch(API_BASE_URL + '/projects?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(projectData)
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to add project: ' + (errorText || response.statusText));
          }
          var data = await response.json();
          setProjects(projects.concat([data]));
          setDropdownData(Object.assign({}, dropdownData, { projects: dropdownData.projects.concat([data]) }));
          setSuccess('Project added successfully');
          setNewProject({ name: '', description: '', status: 'To_Do', delivery_date: '', priority: '' });
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var updateProject = async function(project) {
        setLoading(true);
        var projectData = {
          name: project.name,
          description: project.description || null,
          status: project.status,
          delivery_date: project.delivery_date || null,
          priority: project.priority || null
        };
        try {
          var response = await fetch(API_BASE_URL + '/projects/' + project.project_id + '?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(projectData)
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to update project: ' + (errorText || response.statusText));
          }
          var data = await response.json();
          setProjects(projects.map(function(p) { return p.project_id === project.project_id ? data : p; }));
          setDropdownData(Object.assign({}, dropdownData, {
            projects: dropdownData.projects.map(function(p) { return p.project_id === project.project_id ? data : p; })
          }));
          setEditProject(null);
          setSuccess('Project updated successfully');
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var deleteProject = async function(projectId) {
        setLoading(true);
        try {
          var response = await fetch(API_BASE_URL + '/projects/' + projectId + '?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'DELETE'
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to delete project: ' + (errorText || response.statusText));
          }
          setProjects(projects.filter(function(p) { return p.project_id !== projectId; }));
          setDropdownData(Object.assign({}, dropdownData, { projects: dropdownData.projects.filter(function(p) { return p.project_id !== projectId; }) }));
          setSuccess('Project deleted successfully');
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var handleAddTask = async function(e) {
        e.preventDefault();
        setLoading(true);
        var taskData = {
          title: newTask.title,
          description: newTask.description || null
        };
        try {
          var response = await fetch(API_BASE_URL + '/tasks?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(taskData)
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to add task: ' + (errorText || response.statusText));
          }
          var data = await response.json();
          setTasks(tasks.concat([data]));
          setDropdownData(Object.assign({}, dropdownData, { tasks: dropdownData.tasks.concat([data]) }));
          setSuccess('Task added successfully');
          setNewTask({ title: '', description: '' });
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var updateTask = async function(task) {
        setLoading(true);
        var taskData = {
          title: task.title,
          description: task.description || null
        };
        try {
          var response = await fetch(API_BASE_URL + '/tasks/' + task.task_id + '?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(taskData)
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to update task: ' + (errorText || response.statusText));
          }
          var data = await response.json();
          setTasks(tasks.map(function(t) { return t.task_id === task.task_id ? data : t; }));
          setDropdownData(Object.assign({}, dropdownData, {
            tasks: dropdownData.tasks.map(function(t) { return t.task_id === task.task_id ? data : t; })
          }));
          setEditTask(null);
          setSuccess('Task updated successfully');
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var deleteTask = async function(taskId) {
        setLoading(true);
        try {
          var response = await fetch(API_BASE_URL + '/tasks/' + taskId + '?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'DELETE'
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to delete task: ' + (errorText || response.statusText));
          }
          setTasks(tasks.filter(function(t) { return t.task_id !== taskId; }));
          setDropdownData(Object.assign({}, dropdownData, { tasks: dropdownData.tasks.filter(function(t) { return t.task_id !== taskId; }) }));
          setSuccess('Task deleted successfully');
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var handleAddDeveloper = async function(e) {
        e.preventDefault();
        setLoading(true);
        var developerData = {
          first_name: newDeveloper.first_name,
          last_name: newDeveloper.last_name,
          email: newDeveloper.email,
          password: newDeveloper.password,
          permissions: newDeveloper.permissions
        };
        try {
          var response = await fetch(API_BASE_URL + '/developers?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(developerData)
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to add developer: ' + (errorText || response.statusText));
          }
          var data = await response.json();
          const newDev = {
            developer_id: data.developer_id,
            first_name: data.first_name,
            last_name: data.last_name,
            name: `${data.first_name} ${data.last_name}`.trim(),
            email: data.email,
            permissions: data.permissions
          };
          setDevelopers(developers.concat([newDev]));
          setDropdownData(Object.assign({}, dropdownData, { developers: dropdownData.developers.concat([newDev]) }));
          setSuccess('Developer added successfully');
          setNewDeveloper({ first_name: '', last_name: '', email: '', password: '', permissions: 'low' });
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var updateDeveloper = async function(developer) {
        setLoading(true);
        var developerData = {
          first_name: developer.first_name,
          last_name: developer.last_name,
          email: developer.email,
          permissions: developer.permissions
        };
        if (developer.password) developerData.password = developer.password;
        try {
          var response = await fetch(API_BASE_URL + '/developers/' + developer.developer_id + '?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(developerData)
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to update developer: ' + (errorText || response.statusText));
          }
          var data = await response.json();
          const updatedDev = {
            developer_id: data.developer_id,
            first_name: data.first_name,
            last_name: data.last_name,
            name: `${data.first_name} ${data.last_name}`.trim(),
            email: data.email,
            permissions: data.permissions
          };
          setDevelopers(developers.map(function(d) { return d.developer_id === developer.developer_id ? updatedDev : d; }));
          setDropdownData(Object.assign({}, dropdownData, {
            developers: dropdownData.developers.map(function(d) { return d.developer_id === developer.developer_id ? updatedDev : d; })
          }));
          setEditDeveloper(null);
          setSuccess('Developer updated successfully');
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var deleteDeveloper = async function(developerId) {
        setLoading(true);
        try {
          var response = await fetch(API_BASE_URL + '/developers/' + developerId + '?email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password), {
            method: 'DELETE'
          });
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error('Failed to delete developer: ' + (errorText || response.statusText));
          }
          setDevelopers(developers.filter(function(d) { return d.developer_id !== developerId; }));
          setDropdownData(Object.assign({}, dropdownData, { developers: dropdownData.developers.filter(function(d) { return d.developer_id !== developerId; }) }));
          setSuccess('Developer deleted successfully');
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      var getProjectName = function(id) {
        var project = dropdownData.projects.find(function(p) { return p.project_id === id; });
        return project ? project.name + ' (ID: ' + project.project_id + ')' : 'Project ' + id;
      };

      var getTaskTitle = function(id) {
        var task = dropdownData.tasks.find(function(t) { return t.task_id === id; });
        return task ? task.title + ' (ID: ' + task.task_id + ')' : 'Task ' + id;
      };

      var getDeveloperName = function(id) {
        var developer = dropdownData.developers.find(function(d) { return d.developer_id === id; });
        return developer ? developer.name : 'Developer ' + id;
      };

      var handleLogout = function() {
        localStorage.clear();
        window.location.href = 'login.html';
      };

      return (
        <div className="bg-white rounded-lg shadow-md p-6 sm:p-8 md:p-10">
          <div className="flex justify-between items-center mb-6">
            <div>
              <h1 className="text-xl sm:text-2xl md:text-3xl font-bold text-gray-800">Developer Dashboard</h1>
              <p className="text-sm md:text-base text-gray-600">Welcome, {userName} ({permissions} Permission)</p>
            </div>
            <button onClick={handleLogout} className="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">Logout</button>
          </div>
          {error && <div className="mb-6 p-4 bg-red-100 text-red-700 rounded-lg">{error}</div>}
          {success && <div className="mb-6 p-4 bg-green-100 text-green-700 rounded-lg">{success}</div>}
          {loading && <div className="mb-6 p-4 text-center text-gray-600">Loading...</div>}
          {!loading && (
            <React.Fragment>
              <div className="mb-6">
                <div className="flex space-x-4 border-b">
                  <button onClick={() => handleTabChange('activities')} className={`px-4 py-2 font-medium ${activeTab === 'activities' ? 'border-b-2 border-blue-600 text-blue-600' : 'text-gray-600'}`}>Activities</button>
                  {(permissions === 'medium' || permissions === 'high') && (
                    <React.Fragment>
                      <button onClick={() => handleTabChange('projects')} className={`px-4 py-2 font-medium ${activeTab === 'projects' ? 'border-b-2 border-blue-600 text-blue-600' : 'text-gray-600'}`}>Projects</button>
                      <button onClick={() => handleTabChange('tasks')} className={`px-4 py-2 font-medium ${activeTab === 'tasks' ? 'border-b-2 border-blue-600 text-blue-600' : 'text-gray-600'}`}>Tasks</button>
                    </React.Fragment>
                  )}
                  {permissions === 'high' && (
                    <button onClick={() => handleTabChange('developers')} className={`px-4 py-2 font-medium ${activeTab === 'developers' ? 'border-b-2 border-blue-600 text-blue-600' : 'text-gray-600'}`}>Developers</button>
                  )}
                </div>
              </div>
              {activeTab === 'activities' && (
                <React.Fragment>
                  <h2 className="text-lg md:text-xl font-semibold mb-6 text-gray-700">{permissions === 'high' ? 'All Activities' : 'Your Activities'}</h2>
                  {activities.length === 0 ? (
                    <p className="text-gray-600 mb-6">No activities found.</p>
                  ) : (
                    <div className="p-4 bg-white rounded-lg shadow mb-8 overflow-x-auto">
                      <table className="w-full border-collapse min-w-[600px]">
                        <thead>
                          <tr className="bg-gray-200">
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Developer</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Project</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Task</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Details</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Status</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Estimated Days</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Actions</th>
                          </tr>
                        </thead>
                        <tbody>
                          {activities.map((activity, index) => (
                            <tr key={activity.activity_id || index} className={index % 2 === 0 ? 'bg-gray-50' : 'bg-white'}>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{getDeveloperName(activity.developer_id)}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{getProjectName(activity.project_id)}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{getTaskTitle(activity.task_id)}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{activity.details || '-'}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{activity.status.replace('_', ' ')}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{activity.estimated_days || '-'}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm flex space-x-2">
                                <select
                                  value={activity.status}
                                  onChange={(e) => updateActivityStatus(activity.activity_id, e.target.value)}
                                  className="p-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                                  disabled={loading || (permissions === 'medium' && activity.developer_id !== parseInt(developerId))}
                                >
                                  <option value="To_Do">To Do</option>
                                  <option value="In_Progress">In Progress</option>
                                  <option value="Done">Done</option>
                                </select>
                                {permissions === 'high' && (
                                  <React.Fragment>
                                    <button onClick={() => handleEditActivity(activity)} className="p-1 text-blue-600 hover:text-blue-800" disabled={loading}>Edit</button>
                                    <button onClick={() => deleteActivity(activity.activity_id)} className="p-1 text-red-600 hover:text-red-800" disabled={loading}>Delete</button>
                                  </React.Fragment>
                                )}
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  )}
                  {(permissions === 'low' || permissions === 'medium' || permissions === 'high') && (
                    <React.Fragment>
                      <h2 className="text-lg md:text-xl font-semibold mb-6 mt-8 text-gray-700">Add New Activity</h2>
                      <div className="p-4 bg-white rounded-lg shadow">
                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">Project</label>
                            <select
                              value={newActivity.project_id}
                              onChange={(e) => setNewActivity({ ...newActivity, project_id: e.target.value })}
                              className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                              required
                            >
                              <option value="">Select Project</option>
                              {dropdownData.projects.map((project) => (
                                <option key={project.project_id} value={project.project_id}>
                                  {project.name} (ID: {project.project_id})
                                </option>
                              ))}
                            </select>
                          </div>
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">Task</label>
                            <select
                              value={newActivity.task_id}
                              onChange={(e) => setNewActivity({ ...newActivity, task_id: e.target.value })}
                              className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                              required
                            >
                              <option value="">Select Task</option>
                              {dropdownData.tasks.map((task) => (
                                <option key={task.task_id} value={task.task_id}>
                                  {task.title} (ID: {task.task_id})
                                </option>
                              ))}
                            </select>
                          </div>
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">Details</label>
                            <input
                              type="text"
                              value={newActivity.details}
                              onChange={(e) => setNewActivity({ ...newActivity, details: e.target.value })}
                              className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                              placeholder="Enter activity details"
                            />
                          </div>
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">Status</label>
                            <select
                              value={newActivity.status}
                              onChange={(e) => setNewActivity({ ...newActivity, status: e.target.value })}
                              className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                            >
                              <option value="To_Do">To Do</option>
                              <option value="In_Progress">In Progress</option>
                              <option value="Done">Done</option>
                            </select>
                          </div>
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">Estimated Days</label>
                            <input
                              type="number"
                              value={newActivity.estimated_days}
                              onChange={(e) => setNewActivity({ ...newActivity, estimated_days: e.target.value })}
                              className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                              placeholder="Enter estimated days"
                            />
                          </div>
                        </div>
                        <button
                          onClick={handleAddActivity}
                          disabled={loading}
                          className={`mt-6 w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ${loading ? 'opacity-50 cursor-not-allowed' : ''}`}
                        >
                          {loading ? 'Adding...' : 'Add Activity'}
                        </button>
                      </div>
                    </React.Fragment>
                  )}
                  {editActivity && permissions === 'high' && (
                    <div className="mt-8 p-4 bg-white rounded-lg shadow" ref={activityFormRef} id="edit-activity-form">
                      <h2 className="text-lg md:text-xl font-semibold mb-6 text-gray-700">Edit Activity</h2>
                      <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Project</label>
                          <select
                            value={editActivity.project_id}
                            onChange={(e) => setEditActivity({ ...editActivity, project_id: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          >
                            <option value="">Select Project</option>
                            {dropdownData.projects.map((project) => (
                              <option key={project.project_id} value={project.project_id}>
                                {project.name} (ID: {project.project_id})
                              </option>
                            ))}
                          </select>
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Task</label>
                          <select
                            value={editActivity.task_id}
                            onChange={(e) => setEditActivity({ ...editActivity, task_id: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          >
                            <option value="">Select Task</option>
                            {dropdownData.tasks.map((task) => (
                              <option key={task.task_id} value={task.task_id}>
                                {task.title} (ID: {task.task_id})
                              </option>
                            ))}
                          </select>
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Details</label>
                          <input
                            type="text"
                            value={editActivity.details || ''}
                            onChange={(e) => setEditActivity({ ...editActivity, details: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                            placeholder="Enter activity details"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Status</label>
                          <select
                            value={editActivity.status}
                            onChange={(e) => setEditActivity({ ...editActivity, status: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          >
                            <option value="To_Do">To Do</option>
                            <option value="In_Progress">In Progress</option>
                            <option value="Done">Done</option>
                          </select>
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Estimated Days</label>
                          <input
                            type="number"
                            value={editActivity.estimated_days || ''}
                            onChange={(e) => setEditActivity({ ...editActivity, estimated_days: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                            placeholder="Enter estimated days"
                          />
                        </div>
                      </div>
                      <div className="mt-6 flex space-x-4">
                        <button
                          onClick={() => updateActivity(editActivity)}
                          disabled={loading}
                          className={`w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ${loading ? 'opacity-50 cursor-not-allowed' : ''}`}
                        >
                          {loading ? 'Updating...' : 'Update Activity'}
                        </button>
                        <button onClick={() => setEditActivity(null)} className="w-full py-2 px-4 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400">Cancel</button>
                      </div>
                    </div>
                  )}
                </React.Fragment>
              )}
              {activeTab === 'projects' && (permissions === 'medium' || permissions === 'high') && (
                <React.Fragment>
                  <h2 className="text-lg md:text-xl font-semibold mb-6 text-gray-700">Projects</h2>
                  {projects.length === 0 ? (
                    <p className="text-gray-600 mb-6">No projects found.</p>
                  ) : (
                    <div className="p-4 bg-white rounded-lg shadow mb-8 overflow-x-auto">
                      <table className="w-full border-collapse min-w-[600px]">
                        <thead>
                          <tr className="bg-gray-200">
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Name</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Description</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Status</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Delivery Date</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Priority</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Actions</th>
                          </tr>
                        </thead>
                        <tbody>
                          {projects.map((project, index) => (
                            <tr key={project.project_id || index} className={index % 2 === 0 ? 'bg-gray-50' : 'bg-white'}>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{project.name} (ID: {project.project_id})</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{project.description || '-'}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{project.status.replace('_', ' ')}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{project.delivery_date || '-'}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{project.priority || '-'}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm flex space-x-2">
                                {permissions === 'high' && (
                                  <React.Fragment>
                                    <button onClick={() => handleEditProject(project)} className="p-1 text-blue-600 hover:text-blue-800" disabled={loading}>Edit</button>
                                    <button onClick={() => deleteProject(project.project_id)} className="p-1 text-red-600 hover:text-red-800" disabled={loading}>Delete</button>
                                  </React.Fragment>
                                )}
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  )}
                  <h2 className="text-lg md:text-xl font-semibold mb-6 mt-8 text-gray-700">Add New Project</h2>
                  <div className="p-4 bg-white rounded-lg shadow">
                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Name</label>
                        <input
                          type="text"
                          value={newProject.name}
                          onChange={(e) => setNewProject({ ...newProject, name: e.target.value })}
                          className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          placeholder="Enter project name"
                          required
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Description</label>
                        <input
                          type="text"
                          value={newProject.description}
                          onChange={(e) => setNewProject({ ...newProject, description: e.target.value })}
                          className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          placeholder="Enter project description"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Status</label>
                        <select
                          value={newProject.status}
                          onChange={(e) => setNewProject({ ...newProject, status: e.target.value })}
                          className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                        >
                          <option value="To_Do">To Do</option>
                          <option value="In_Progress">In Progress</option>
                          <option value="Done">Done</option>
                        </select>
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Delivery Date</label>
                        <input
                          type="date"
                          value={newProject.delivery_date}
                          onChange={(e) => setNewProject({ ...newProject, delivery_date: e.target.value })}
                          className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Priority</label>
                        <select
                          value={newProject.priority}
                          onChange={(e) => setNewProject({ ...newProject, priority: e.target.value })}
                          className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                        >
                          <option value="">Select Priority</option>
                          <option value="Low">Low</option>
                          <option value="Medium">Medium</option>
                          <option value="High">High</option>
                        </select>
                      </div>
                    </div>
                    <button
                      onClick={handleAddProject}
                      disabled={loading}
                      className={`mt-6 w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ${loading ? 'opacity-50 cursor-not-allowed' : ''}`}
                    >
                      {loading ? 'Adding...' : 'Add Project'}
                    </button>
                  </div>
                  {editProject && permissions === 'high' && (
                    <div className="mt-8 p-4 bg-white rounded-lg shadow" ref={projectFormRef} id="edit-project-form">
                      <h2 className="text-lg md:text-xl font-semibold mb-6 text-gray-700">Edit Project</h2>
                      <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Name</label>
                          <input
                            type="text"
                            value={editProject.name}
                            onChange={(e) => setEditProject({ ...editProject, name: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                            placeholder="Enter project name"
                            required
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Description</label>
                          <input
                            type="text"
                            value={editProject.description || ''}
                            onChange={(e) => setEditProject({ ...editProject, description: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                            placeholder="Enter project description"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Status</label>
                          <select
                            value={editProject.status}
                            onChange={(e) => setEditProject({ ...editProject, status: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          >
                            <option value="To_Do">To Do</option>
                            <option value="In_Progress">In Progress</option>
                            <option value="Done">Done</option>
                          </select>
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Delivery Date</label>
                          <input
                            type="date"
                            value={editProject.delivery_date || ''}
                            onChange={(e) => setEditProject({ ...editProject, delivery_date: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Priority</label>
                          <select
                            value={editProject.priority || ''}
                            onChange={(e) => setEditProject({ ...editProject, priority: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          >
                            <option value="">Select Priority</option>
                            <option value="Low">Low</option>
                            <option value="Medium">Medium</option>
                            <option value="High">High</option>
                          </select>
                        </div>
                      </div>
                      <div className="mt-6 flex space-x-4">
                        <button
                          onClick={() => updateProject(editProject)}
                          disabled={loading}
                          className={`w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ${loading ? 'opacity-50 cursor-not-allowed' : ''}`}
                        >
                          {loading ? 'Updating...' : 'Update Project'}
                        </button>
                        <button onClick={() => setEditProject(null)} className="w-full py-2 px-4 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400">Cancel</button>
                      </div>
                    </div>
                  )}
                </React.Fragment>
              )}
              {activeTab === 'tasks' && (permissions === 'medium' || permissions === 'high') && (
                <React.Fragment>
                  <h2 className="text-lg md:text-xl font-semibold mb-6 text-gray-700">Tasks</h2>
                  {tasks.length === 0 ? (
                    <p className="text-gray-600 mb-6">No tasks found.</p>
                  ) : (
                    <div className="p-4 bg-white rounded-lg shadow mb-8 overflow-x-auto">
                      <table className="w-full border-collapse min-w-[600px]">
                        <thead>
                          <tr className="bg-gray-200">
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Title</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Description</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Actions</th>
                          </tr>
                        </thead>
                        <tbody>
                          {tasks.map((task, index) => (
                            <tr key={task.task_id || index} className={index % 2 === 0 ? 'bg-gray-50' : 'bg-white'}>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{task.title} (ID: {task.task_id})</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{task.description || '-'}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm flex space-x-2">
                                {permissions === 'high' && (
                                  <React.Fragment>
                                    <button onClick={() => handleEditTask(task)} className="p-1 text-blue-600 hover:text-blue-800" disabled={loading}>Edit</button>
                                    <button onClick={() => deleteTask(task.task_id)} className="p-1 text-red-600 hover:text-red-800" disabled={loading}>Delete</button>
                                  </React.Fragment>
                                )}
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  )}
                  <h2 className="text-lg md:text-xl font-semibold mb-6 mt-8 text-gray-700">Add New Task</h2>
                  <div className="p-4 bg-white rounded-lg shadow">
                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Title</label>
                        <input
                          type="text"
                          value={newTask.title}
                          onChange={(e) => setNewTask({ ...newTask, title: e.target.value })}
                          className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          placeholder="Enter task title"
                          required
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Description</label>
                        <input
                          type="text"
                          value={newTask.description}
                          onChange={(e) => setNewTask({ ...newTask, description: e.target.value })}
                          className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          placeholder="Enter task description"
                        />
                      </div>
                    </div>
                    <button
                      onClick={handleAddTask}
                      disabled={loading}
                      className={`mt-6 w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ${loading ? 'opacity-50 cursor-not-allowed' : ''}`}
                    >
                      {loading ? 'Adding...' : 'Add Task'}
                    </button>
                  </div>
                  {editTask && permissions === 'high' && (
                    <div className="mt-8 p-4 bg-white rounded-lg shadow" ref={taskFormRef} id="edit-task-form">
                      <h2 className="text-lg md:text-xl font-semibold mb-6 text-gray-700">Edit Task</h2>
                      <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Title</label>
                          <input
                            type="text"
                            value={editTask.title}
                            onChange={(e) => setEditTask({ ...editTask, title: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                            placeholder="Enter task title"
                            required
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Description</label>
                          <input
                            type="text"
                            value={editTask.description || ''}
                            onChange={(e) => setEditTask({ ...editTask, description: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                            placeholder="Enter task description"
                          />
                        </div>
                      </div>
                      <div className="mt-6 flex space-x-4">
                        <button
                          onClick={() => updateTask(editTask)}
                          disabled={loading}
                          className={`w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ${loading ? 'opacity-50 cursor-not-allowed' : ''}`}
                        >
                          {loading ? 'Updating...' : 'Update Task'}
                        </button>
                        <button onClick={() => setEditTask(null)} className="w-full py-2 px-4 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400">Cancel</button>
                      </div>
                    </div>
                  )}
                </React.Fragment>
              )}
              {activeTab === 'developers' && permissions === 'high' && (
                <React.Fragment>
                  <h2 className="text-lg md:text-xl font-semibold mb-6 text-gray-700">Developers</h2>
                  {developers.length === 0 ? (
                    <p className="text-gray-600 mb-6">No developers found.</p>
                  ) : (
                    <div className="p-4 bg-white rounded-lg shadow mb-8 overflow-x-auto">
                      <table className="w-full border-collapse min-w-[600px]">
                        <thead>
                          <tr className="bg-gray-200">
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Name</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Email</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Permissions</th>
                            <th className="p-2 md:p-3 text-left text-xs md:text-sm font-medium text-gray-700">Actions</th>
                          </tr>
                        </thead>
                        <tbody>
                          {developers.map((developer, index) => (
                            <tr key={developer.developer_id || index} className={index % 2 === 0 ? 'bg-gray-50' : 'bg-white'}>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{developer.name} (ID: {developer.developer_id})</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{developer.email}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm text-gray-600">{developer.permissions}</td>
                              <td className="p-2 md:p-3 text-xs md:text-sm flex space-x-2">
                                <button onClick={() => handleEditDeveloper(developer)} className="p-1 text-blue-600 hover:text-blue-800" disabled={loading}>Edit</button>
                                <button onClick={() => deleteDeveloper(developer.developer_id)} className="p-1 text-red-600 hover:text-red-800" disabled={loading}>Delete</button>
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  )}
                  <h2 className="text-lg md:text-xl font-semibold mb-6 mt-8 text-gray-700">Add New Developer</h2>
                  <div className="p-4 bg-white rounded-lg shadow">
                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">First Name</label>
                        <input
                          type="text"
                          value={newDeveloper.first_name}
                          onChange={(e) => setNewDeveloper({ ...newDeveloper, first_name: e.target.value })}
                          className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          placeholder="Enter first name"
                          required
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Last Name</label>
                        <input
                          type="text"
                          value={newDeveloper.last_name}
                          onChange={(e) => setNewDeveloper({ ...newDeveloper, last_name: e.target.value })}
                          className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          placeholder="Enter last name"
                          required
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
                        <input
                          type="email"
                          value={newDeveloper.email}
                          onChange={(e) => setNewDeveloper({ ...newDeveloper, email: e.target.value })}
                          className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          placeholder="Enter developer email"
                          required
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Password</label>
                        <input
                          type="password"
                          value={newDeveloper.password}
                          onChange={(e) => setNewDeveloper({ ...newDeveloper, password: e.target.value })}
                          className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          placeholder="Enter password"
                          required
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Permissions</label>
                        <select
                          value={newDeveloper.permissions}
                          onChange={(e) => setNewDeveloper({ ...newDeveloper, permissions: e.target.value })}
                          className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                        >
                          <option value="low">Low</option>
                          <option value="medium">Medium</option>
                          <option value="high">High</option>
                        </select>
                      </div>
                    </div>
                    <button
                      onClick={handleAddDeveloper}
                      disabled={loading}
                      className={`mt-6 w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ${loading ? 'opacity-50 cursor-not-allowed' : ''}`}
                    >
                      {loading ? 'Adding...' : 'Add Developer'}
                    </button>
                  </div>
                  {editDeveloper && permissions === 'high' && (
                    <div className="mt-8 p-4 bg-white rounded-lg shadow" ref={developerFormRef} id="edit-developer-form">
                      <h2 className="text-lg md:text-xl font-semibold mb-6 text-gray-700">Edit Developer</h2>
                      <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">First Name</label>
                          <input
                            type="text"
                            value={editDeveloper.first_name}
                            onChange={(e) => setEditDeveloper({ ...editDeveloper, first_name: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                            placeholder="Enter first name"
                            required
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Last Name</label>
                          <input
                            type="text"
                            value={editDeveloper.last_name}
                            onChange={(e) => setEditDeveloper({ ...editDeveloper, last_name: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                            placeholder="Enter last name"
                            required
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
                          <input
                            type="email"
                            value={editDeveloper.email}
                            onChange={(e) => setEditDeveloper({ ...editDeveloper, email: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                            placeholder="Enter developer email"
                            required
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Password (leave blank to keep unchanged)</label>
                          <input
                            type="password"
                            value={editDeveloper.password || ''}
                            onChange={(e) => setEditDeveloper({ ...editDeveloper, password: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                            placeholder="Enter new password"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Permissions</label>
                          <select
                            value={editDeveloper.permissions}
                            onChange={(e) => setEditDeveloper({ ...editDeveloper, permissions: e.target.value })}
                            className="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                          >
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                          </select>
                        </div>
                      </div>
                      <div className="mt-6 flex space-x-4">
                        <button
                          onClick={() => updateDeveloper(editDeveloper)}
                          disabled={loading}
                          className={`w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ${loading ? 'opacity-50 cursor-not-allowed' : ''}`}
                        >
                          {loading ? 'Updating...' : 'Update Developer'}
                        </button>
                        <button onClick={() => setEditDeveloper(null)} className="w-full py-2 px-4 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400">Cancel</button>
                      </div>
                    </div>
                  )}
                </React.Fragment>
              )}
            </React.Fragment>
          )}
        </div>
      );
    }

    try {
      var root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<Homepage />);
    } catch (error) {
      var fallback = document.getElementById('error-fallback');
      fallback.classList.remove('hidden');
      fallback.innerHTML = 'Failed to load homepage: ' + error.message;
    }
  </script>
</body>
</html>
